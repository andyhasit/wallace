!function(){"use strict";const t=document,n=t.createElement("template");const e=t=>"string"==typeof t;function i(t){this.e=t,this._pool=void 0}function o(t){return e(t)?document.getElementById(t):t}function s(t,n,e){const i=r(t,n);return i.props=e,i.init(),i.update(),i}function r(t,n){const e=new t(n);return e.__bv(e,t.prototype),e}function c(t,n){this._v=t,this._f=n,this._k=[],this._p={}}i.prototype={__ge:function(n){return n.e||t.createTextNode(n)},getAtt:function(t){return this.e[t]},getValue:function(){return this.e.value},isChecked:function(){return this.e.checked},append:function(t){return this.e.appendChild(this.__ge(t)),this},att:function(t,n){return this.e[t]=n,this},pool:function(t){return this._pool=t,this},clear:function(){return this.e.innerHTML="",this.e.textContent="",this.e.value="",this},checked:function(t){return this.e.checked=!!t,this},child:function(t){return this.e.innerHTML="",this.e.appendChild(t.e),this},css:function(t){return this.e.className=t,this},cssAdd:function(t){return this.e.classList.add(t),this},cssRemove:function(t){return this.e.classList.remove(t),this},cssToggle:function(t){return this.e.classList.toggle(t),this},disabled:function(t){return this.e.disabled=t,this},href:function(t){return this.att("href",t)},html:function(t){return this.e.innerHTML=t,this},id:function(t){return this.att("id",t)},inner:function(t){Array.isArray(t)||(t=[t]);const n=this.e;n.innerHTML="";for(var e=0,i=t.length;e<i;e++)n.appendChild(this.__ge(t[e]));return this},items:function(t,n){return this._pool.patch(this.e,t,n),this},on:function(t,n){return this.e.addEventListener(t,(t=>n(this,t))),this},replace:function(t){return this.e.parentNode.replaceChild(t,this.e),this},src:function(t){return this.att("src",t)},style:function(t,n){return this.e.style[n]=t,this},swap:function(t,n){return this.child(this._pool.getOne(t,n)),this},text:function(t){return this.e.textContent=t,this},hidden:function(t){return this.e.hidden=t,this},value:function(t){return this.e.value=t,this}};const u=c.prototype;function h(t){this._v=t,this._p=[],this._c=0}function p(t,n){this._m=t,this._f=n,this._i={}}function _(t,n,e){let i=e-1;for(let e=n.length-1;e>i;e--)t.removeChild(n[e])}function l(t,n,e){const i=t.indexOf(n);i!=e&&t.splice(e,0,t.splice(i,1)[0])}u.getOne=function(t,n){return this._get(this._p,this._v,this._f(t),t,n)},u.patch=function(t,n,e){const i=this._p,o=this._v,s=this._f,r=t.childNodes,c=n.length,u=this._k,h=[];let p,a,f,d=u.length+1;for(let _=0;_<c;_++)p=n[_],a=s(p),f=this._get(i,o,a,p,e),h.push(a),_>d?t.appendChild(f.e):a!==u[_]&&(t.insertBefore(f.e,r[_]),l(u,a,_));this._k=h,_(t,r,c)},u._get=function(t,n,e,i,o){let r;return t.hasOwnProperty(e)?(r=t[e],r.setProps(i)):(r=s(n,o,i),t[e]=r),r},h.prototype.patch=function(t,n,e){const i=this._p,o=this._v,r=t.childNodes,c=n.length;let u,h,p=i.length,l=this._c;for(let r=0;r<c;r++)u=n[r],r<p?(h=i[r],h.setProps(u)):(h=s(o,e,u),i.push(h),p++),r>=l&&t.appendChild(h.e);this._c=c,_(t,r,c)},p.prototype.getOne=function(t,n){return this._i.hasOwnProperty(t)||(this._i[t]=this._m.hasOwnProperty(t)?n.nest(this._m[t]):this._f(t,n)),this._i[t]};const a=[];var f={track:function(t){a.push({component:t,isAttached:t.__ia()})},flush:function(){for(let t=0,n=a.length;t<n;t++){let n=a[t],e=n.component,i=e.__ia();if(i!==n.isAttached){(i?e.mount:e.unmount).apply(e),n.isAttached=i}}}};function d(t){this.callbacks=t,this.run={}}d.prototype={get:function(t,n){const e=this.run;if(void 0===e[n]){let i=t.__ov[n];i=void 0===i?"":i;const o=this.callbacks[n](t,t.props),s=o!==i;t.__ov[n]=o;const r={n:o,o:i,c:s};return e[n]=r,r}return e[n]},reset:function(){this.run={}}};const v=function(){};function g(t){const n=this;n.parent=t,n.props=void 0,n.e=null,n.el=null,n.__nv=[],n.__ov={}}g.extend=function(t){var n=t._base||g,e=function(t){n.call(this,t)};return delete t._base,e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.assign(e.prototype,t),e};var w=g.prototype;w.onUpdate=v,w.afterUpdate=v,w.onInit=v,w.afterInit=v,w.init=function(){this.onInit();for(let t in this.__ip){let n=this.el[t],e=this.__ip[t];e&&(n.props=e(this,this.props)),n.init()}this.afterInit()},w.bubble=function(t){let n=this.parent;for(;n;){let e=n[t];if(e)return e.apply(n,Array.prototype.slice.call(arguments,1));n=n.parent}throw new Error("Bubble popped.")},w.move=function(t){if(this.parent&&this.parent.__nv){const t=this.parent.__nv;t.splice(t.indexOf(this),1)}this.parent=t},w.nest=function(t,n){const e=s(t,this,n||this.props);return this.__nv.push(e),e},w.lookup=function(t){return this.__qc.get(this,t)},w.resetLookups=function(){this.__qc.reset()},w.setProps=function(t){return this.props=t,this.update(),this},w.trackMounting=function(){this.__mt.track(this)},w.update=function(){this.onUpdate(),this.resetLookups(),this.updateSelf(),this.updateNested(),this.afterUpdate()},w.updateSelf=function(){let t,n,e,i,o,s,r=0;const c=this.__wc,u=c.length;for(;r<u;)t=c[r],n=this.el[t.wk],i=t.sq,r++,s=!0,i&&(o=!!this.lookup(i).n,s=t.rv?o:!o,e=s?0:t.sc,n.hidden(!s),r+=e),s&&y(this,n,t.cb)},w.updateNested=function(){const t=this.__nv;for(let n=0,e=t.length;n<e;n++){let e=t[n];e.__ia()&&e.update()}for(let t in this.__ip){let n=this.__ip[t],e=this.el[t];n?e.setProps(n(this,this.props)):e.update()}},w.__wa=function(t,n,e,i,o){return{wk:t,sq:n,rv:e,sc:i,cb:o}};const y=(t,n,e)=>{for(let i in e){let o=e[i];if("*"===i)o.call(t,n,t.props,t);else{const{n:e,o:s,c:r}=t.lookup(i);r&&o.call(t,e,s,n,t.props,t)}}};w.__mt=f,w.__ni=function(t,n){const e=r(n,this);return this.__gw(t).replace(e.e),e},w.__ex=function(t,n,e){var i=e||function(n){t.call(this,n)};return i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),n&&Object.assign(i.prototype,n),i},w.pool=function(t,n){return n?new c(t,n):new h(t)},w.__ic=function(t,n){return new p(t,n)},w.__bd=function(t){var e;void 0===t.__cn&&(t.__cn=(e=t.__ht,n.innerHTML=e,n.content.firstChild)),this.e=t.__cn.cloneNode(!0)},w.__gw=function(t){return new i(this.__fe(t))},w.__fe=function(t){return t.reduce(((t,n)=>t.childNodes[n]),this.e)},w.__ia=function(){let t=this.e;for(;t;){if(t===document)return!0;t=t.parentNode}return!1},w.__lu=function(t){return new d(t)},w.__sv=function(){const t=function(t){g.call(this,t)};return t.prototype=new g,t},w.hide=function(t){this.e.hidden=t};var b={createComponent:s,h:function(n){return new i(t.createElement(n))},mount:function(t,n,e,i){const r=s(n,i,e),c=o(t);return c.parentNode.replaceChild(r.e,c),r},KeyedPool:c,InstancePool:p,isStr:e,SequentialPool:h,Component:g,Wrapper:i,wrap:function(t){return new i(o(t))}};const m=(t,n)=>{const e={get(t,n){if("isProxy"==n)return!0;const i=t[n];return void 0!==i?(i.isProxy||"object"!=typeof i||(t[n]=new Proxy(i,e)),t[n]):void 0},set:(t,e,i)=>(console.log("Setting",t,`.${e} to equal`,i),t[e]=i,n.update(),!0)};return new Proxy(t,e)},k=b.Component.extend({});var x=k.prototype;x.__ht="<div><span>{p.clicks}</span><button>+</button></div>",x.__wc=[x.__wa("_1",0,0,0,{"p.clicks":function(t,n,e,i,o){e.text(t)}}),x.__wa("_2",0,0,0,{})],x.__qc=x.__lu({"p.clicks":function(t,n){return n.clicks}}),x.__ip={},x.__bv=function(t,n){t.__bd(n),t.el={_1:t.__gw([0,0]),_2:t.__gw([1]).on("click",(function(n,e){t.props.clicks+=1}))}},x.__cn=void 0;const C=b.Component.extend({});var P=C.prototype;P.__ht="<div><span>Total: <text>.</text></span><button>Add</button><div></div></div>",P.__wc=[P.__wa("_1",0,0,0,{"getTotal(p)":function(t,n,e,i,o){e.text(t)}}),P.__wa("_2",0,0,0,{}),P.__wa("_3",0,0,0,{"*":function(t,n,e){t.items(n,e)}})],P.__qc=P.__lu({"getTotal(p)":function(t,n){return n.reduce(((t,n)=>t+n.clicks),0)}}),P.__ip={},P.__bv=function(t,n){t.__bd(n),t.el={_1:t.__gw([0,1]),_2:t.__gw([1]).on("click",(function(n,e){t.props.push({clicks:0})})),_3:t.__gw([2]).pool(t.pool(k))}},P.__cn=void 0,C.prototype.onInit=function(){this.props=m(this.props,this)},k.prototype.onInit=function(){this.props=m(this.props,this)},b.mount("main",C,[])}();
